; accounts, pp,pp_changes
; Сводная, Вижайская, 20.xls
; 5904376408 ТСЖ ВИЖАЙСКАЯ 20.zip
;
; Лицевой счет		Задолженность на начало
; Итого начислено  Итого оплачено		Всего на конец месяца	Итоговая сумма на конец месяца

; Всего			Водоотведение		Водоснабжение 	Горячая вода 		Резервный фонд		
; Содержание и текущий ремонт	Электроэнергия

[check]
; Поиск ключевого значения по строке(ам) для определения совместимости
; входных данных и конфигурации
row=0<15
column=0<20
pattern_1=Н\s?А\s?Ч\s?И\s?С\s?Л\s?Е\s?Н\s?И\s?Я\s?.+ О\s?П\s?Л\s?А\s?Т\s?Ы
pattern=Сводная ведомость

[main]
path_output=output
row_start=0
page_name=
page_index=0
max_columns=150
max_rows_heading=15

[headers_0]
name=period
row=0,1
column=0<2
pattern=(?<=за)\s*[А-Яа-я0-9\s\.]+\s*[0-9]{4}

[headers_1]
name=address
row=2
column=0,1
pattern=.*(?:ул|д\.|кв\.|г\.|г,|бул|пер|,\s*[0-9]+).*

[col_0]
name=ЛС
pattern=Лицевой счет
offset_pattern=Н\s?А\s?Ч\s?И\s?С\s?Л\s?Е\s?Н\s?И\s?Я
offset_row=+0
offset_col=-60<+4
condition_begin_team=(?:(?<=,)|(?<=л\/с №)|^)\s*[0-9а-я()\s\/-]+\s*$

[col_1]
name=Долг
pattern=Задолженность на начало
offset=@0

[col_2]
name=Всего
pattern=Всего
border_column_right=6
offset=@0
offset_row=-1

[col_3]
name=ГВС
is_optional=true
pattern=^\s*Горячая вода\s*$
pattern_0=(?:горяч).+(?:счетчик)
pattern_1=^Горячее водоснабжение$
pattern_2=ГВС
border_column_right=6
offset=@0
offset_row=-1

[col_4]
name=ХВС
is_optional=true
pattern=^Холодная вода$
pattern_0=ХВС
pattern_1=(?:холод).+(?:счетчик)
pattern_2=^Холодное водоснабжение$
border_column_right=6
offset=@0
offset_row=-1

[col_5]
name=Электричество
is_optional=true
pattern=^\s*$Электроэнергия\s*$
pattern_0=(?:электр).+(?:счетчик)
pattern_1=^\s*Электроэнергия\s*$
pattern_2=^\s*Электрическая энергия\s*$
border_column_right=6
offset=@0
offset_row=-1

[col_6]
name=Итого(начислено)
pattern=Итого начислено
offset=@0

[col_7]
name=Всего(оплачено)
is_optional=true
pattern=Всего
border_column_left=6
offset_row=-1
offset_col=+0
offset_pattern=О\s?П\s?Л\s?А\s?Т\s?Ы

[col_8]
name=Оплата
is_optional=true
pattern=Оплата
border_column_left=6

[col_9]
name=Итого оплачено
pattern=Итого оплачено

[col_10]
name=Сальдо на конец месяца
pattern=Итоговая сумма на конец месяца

[col_11]
name=Услуги
is_optional=true
pattern=^((?!холодн|горяч|электр|всего|итого|долг|задолж|№|н а ч|о п л).)+$
border_column_right=6
offset=@0
offset_row=-1

;---------------  Документы -------------------------
; --------- accounts -----------
[doc_0]
; Лицевые счета
name=accounts

[accounts_0]
; ИНН, ОГРН или OrgID
name=org_ppa_guid
pattern=@
col_config=0
row_data=0
func=inn

[accounts_1]
; Внутренний идентификатор договора
name=contract_internal_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl

[accounts_2]
; Внутренний идентификатор ЛС
name=internal_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl

[accounts_3]
; Идентификатор дома GUID
name=fias

[accounts_4]
; Адрес дома
name=address
pattern=@0
col_config=1
row_data=0
func=param(address)

[accounts_5]
; Номер помещения (если есть)
name=room_number
pattern=(?:(?<=Кв.)|(?<=Оф.)).+[0-9]+\s*(?=,)
col_config=0
row_data=0

[accounts_6]
; ГИС. Идентификатор квартиры GUID
name=gis_premises_id

[accounts_7]
; ГИС. Идентификатор блока GUID
name=gis_block_id

[accounts_8]
; ГИС. Идентификатор комнаты GUID
name=gis_room_id

[accounts_9]
; ГИС. Идентификатор ЛС GUID
name=gis_account_id
pattern=@0
col_config=0
row_data=0
func=id,guid

[accounts_10]
; Номер ЛС
name=account_number
pattern=@1
col_config=0
row_data=0

[accounts_11]
; ГИС. Идентификатор ЛС (20)
name=gis_account_service_id

[accounts_12]
; ГИС. Номер ЛИ (20)
name=gis_account_unified_number

[accounts_13]
; Общая площадь помещения
name=total_square

[accounts_14]
; Жилая площадь
name=residential_square

[accounts_15]
; Кол-во проживающих
name=living_person_number

[accounts_16]
; Часовой пояс. Кол-во часов + или - от UTC
name=timezone

[accounts_17]
; Альтернативный идентификатор ЛС, используется в некоторых конфигурациях.
; Если  internal_id, по каким-то причинам не получается использовать.
name=account_identifier
pattern=@0
col_config=0
row_data=0
func=id,id,spacerepl

[accounts_18]
; Признак нежилого помещения (0 1)
name=not_residential

; --------- pp -----------
[doc_1]
name=pp

[pp_0]
;ИНН, ОГРН или OrgID
name=org_ppa_guid
pattern=@
col_config=0
row_data=0
func=inn

[pp_1]
; Внутренний идентификатор ПД
name=internal_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl

[pp_2]
; Внутренний идентификатор ЛС
name=account_internal_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl

[pp_3]
; ГИС. Идентификатор ПП
name=gis_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl
; func=id,id,hash

[pp_4]
; Месяц (первый день месяца)
name=month
pattern=@0
col_config=0
row_data=0
func=period

[pp_5]
; Сальдо на начало месяца (<0 переплата, >0 задолженность)
name=credit
pattern=@0
col_config=0
row_data=0
offset_col_config=1
offset_type=float
offset_pattern=.+

[pp_6]
; Сальдо на конец месяца (<0 переплата, >0 задолженность)
name=saldo
pattern=@0
col_config=0
row_data=0
offset_col_config=10
offset_type=float
offset_pattern=.+

[pp_7]
; Оплачено денежных средств в расчетный период
name=payment_value
pattern=@0
col_config=0
row_data=0
offset_col_config=9
offset_type=float
offset_pattern=.+

[pp_8]
; Учтены платежи, поступившие до указанного числа расчетного периода включительно
name=payment_date
pattern=@0
col_config=0
row_data=0
func=period

[pp_9]
; Сумма счета, учетом задолженности/переплаты
name=bill_value
pattern=@0
col_config=0
row_data=0
offset_col_config=6
offset_type=float
offset_pattern=.+

[pp_10]
; Номер расчетного счета
name=account_number
; pattern=@0
col_config=1
row_data=

[pp_11]
; БИК банка
name=bank_bik
; pattern=@0
col_config=0
row_data=
; func=param(bank_account)
; func_pattern=(?<=БИК)\s*[0-9]{9}


; --------- pp_changes -----------
[doc_2]
; Документ Начисления платежей
name=pp_charges
required_fields=calc_value

[pp_charges_0]
; ИНН, ОГРН или OrgID
name=org_ppa_guid
pattern=@
col_config=0
row_data=0
func=inn

[pp_charges_1]
; Внутренний идентификатор начисления
name=internal_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl

[pp_charges_2]
; Внутренний идентификатор платежного документа
name=pp_internal_id
pattern=@0
col_config=0
row_data=0
func=id,spacerepl

[pp_charges_3]
; Сумма начисления при однотарифном начислении (поля:Элект,ХВС,Услуги)
name=calc_value
pattern=.+
col_config=3,4,5,11
type=float
row_data=0

[pp_charges_4]
; тариф при однотарифном начислении (поля: ГВС, ХВС)
name=tariff
pattern=
col_config=
row_data=0

[pp_charges_5]
; Идентификатор услуги (поля: ГВС,ХВС,Элект,Услуги)
; применена функция column_name, которая возвращает наименование группы или колонки
name=service_internal_id
pattern=.+
col_config=3,4,5,11
row_data=0
func=column_name

[pp_charges_6]
; кол-во услуги  при однотарифном начислении (поля: ГВС,ХВС,Элект)
name=rr
pattern=
col_config=
row_data=0

[pp_charges_7]
; перерасчет
name=recalculation
pattern=
col_config=
row_data=3
func=

[pp_charges_8]
; Начислено за расчетный период,с  учетом перерасчета
name=accounting_period_total
pattern=.+
col_config=3,4,5,11
type=float
row_data=

