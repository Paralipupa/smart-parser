Парсинг xml в файл json|csv

Конфигурационный файла ini:

[main]
path=строка ;путь выходного файла
row_start=
page_name=
page_index=
max_columns=число  ;количество просматриваемых колонок для поиска заголовков таблицы
max_rows_heading=число  ;количество просматриваемых строк для поиска заголовков таблицы
columns_count=число  ;количесто актуальных колонок в таблице
documents_count=число ;количество выходных документов
parameters_count=число  ;количество параметров (извлеченных данных)

[param_x] ; x-число в диапазоне [0,parameters_count]
name=строка   ; имя параметра, например - period
row=число|числа через запятую   ;строки ячеек, для определения параметра
column=число|числа через запятую    ;колонки ячеек, для определения параметра
pattern=регулярное выражение    ;поиск значения параметра 

period, address - обязательные параметры (если нет, то по умолчанию пустые значения)


[col_x] ; x-число в диапазоне [0,columns_count]
pattern=строка|регулярное выражение   ; заголовок колонки 
condition_team=регулярное выражение   ; начала области для разбиения данных таблицы по строкам
row_offset=число|числа через запятую   ; номера строк поиска "якоря" для заголовка данной колонки
col_offset=число|числа через запятую   ; номера столбцов поиска "якоря" для заголовка данной колонки
pattern_offset=строка|регулярное выражение   ; якорь для заголовка колонки 
is_include_offset=1|0  ; включать или нет якорь в заголовок при формировании данных (для отладки)

[doc_x] ; x-число в диапазоне [0,documents_count]
name=строка   ; наименование выходного документа, например accounts
fields_count=число  ; количество поле в документе

[имя_x] ; имя=name из раздела [doc_x], например accounts, x-число в диапазоне [0,fields_count_count]
name=строка  ; имя поля
pattern=регулярное выражение  ; шаблон для поиска значения данного поля
col_config=число|числа через запятую   ; номер(а) колонок для поиска по заданному шаблону в конфигурации из диапазона [0, col_x]
col_offset=число ; номер колонки откуда берутся значения при верном поиске по pattern по колонке col_config
pattern_offset=регулярное выражение  ; для данных из колонки col_offset
row_data=число|числа через запятую|пусто  ; номера строк в разбиваемой области таблицы, если пусто то берутся все строки
func=имена встроенных функций через запятую для обработки полученного значения поля, например: id,uuid

Встроенные функции (возвращают строку):
    'inn': ИНН
    'period': Первое значение периода (dd.mm.yyyy)
    'period_last': Последнее значение периода (dd.mm.yyyy)
    'hash': хеш по значению
    'uuid': guid по значению
    'id': значение с добавлением периода yyyy_mm
